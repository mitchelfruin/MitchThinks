<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="author" content="Mitchel Fruin">
    <meta name="description" content="Mitchel Fruin&#39;s personal website">
    <meta name="keywords" content="blog,data science,personal">

    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Chaos with a pocket calculator."/>
<meta name="twitter:description" content="Introduction to chaos theory using the simple population growth example from Robert May&#39;s classic paper."/>

    <meta property="og:title" content="Chaos with a pocket calculator." />
<meta property="og:description" content="Introduction to chaos theory using the simple population growth example from Robert May&#39;s classic paper." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/chaos_logistic_map/" />
<meta property="article:published_time" content="2019-09-25T00:00:00+00:00" />
<meta property="article:modified_time" content="2019-09-25T00:00:00+00:00" />


    
      <base href="/posts/chaos_logistic_map/">
    
    <title>
  Chaos with a pocket calculator. · MitchThinks
</title>

    
      <link rel="canonical" href="/posts/chaos_logistic_map/">
    

    <link href="https://fonts.googleapis.com/css?family=Lato:400,700%7CMerriweather:300,700%7CSource+Code+Pro:400,700" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" integrity="sha256-l85OmPOjvil/SOvVt3HnSSjzF1TUMyT9eV0c2BzEGzU=" crossorigin="anonymous" />

    
      
      
      <link rel="stylesheet" href="/css/coder.min.28d751104f30c16da1aa1bb04015cbe662cacfe0d1b01af4f2240ad58580069c.css" integrity="sha256-KNdREE8wwW2hqhuwQBXL5mLKz&#43;DRsBr08iQK1YWABpw=" crossorigin="anonymous" media="screen" />
    

    

    

    

    
    
    <link rel="icon" type="image/png" href="/images/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/images/favicon-16x16.png" sizes="16x16">

    <meta name="generator" content="Hugo 0.56.3" />
  </head>

  <body class=" ">
    <main class="wrapper">
      <nav class="navigation">
  <section class="container">
    <a class="navigation-title" href="/">
      MitchThinks
    </a>
    <input type="checkbox" id="menu-toggle" />
    <label class="menu-button float-right" for="menu-toggle"><i class="fas fa-bars"></i></label>
    <ul class="navigation-list">
      
        
          <li class="navigation-item">
            <a class="navigation-link" href="/posts/">Posts</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="/tags/">Tags</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="/about/">About</a>
          </li>
        
      
      
    </ul>
  </section>
</nav>

<link href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" rel="stylesheet">

<head>
  <link rel="icon" type="image/ico" href="/images/favicon.ico">
</head>

      <div class="content">
        
  <section class="container post">
    <article>
      <header>
        <div class="post-title">
          <h1 class="title">Chaos with a pocket calculator.</h1>
        </div>
        <div class="post-meta">
          <div class="date">
            <span class="posted-on">
              <i class="fas fa-calendar"></i>
              <time datetime='2019-09-25T00:00:00Z'>
                Sep 25, 2019
              </time>
            </span>
            <span class="reading-time">
              <i class="fas fa-clock"></i>
              7 minutes read
            </span>
          </div>
          
          <div class="tags">
  <i class="fas fa-tag"></i>
    <a href="/tags/complexity/">Complexity</a>
      <span class="separator">•</span>
    <a href="/tags/interactive-visualisation/">Interactive Visualisation</a></div>

        </div>
      </header>

      <div>
        

<div id="TOC">
<ul>
<li><a href="#the-logistic-map"><span class="toc-section-number">1</span> The logistic map</a></li>
<li><a href="#summarising-complexity"><span class="toc-section-number">2</span> Summarising complexity</a></li>
<li><a href="#building-non-linear-intuitions"><span class="toc-section-number">3</span> Building non-linear intuitions</a></li>
<li><a href="#studying-non-elephant-animals"><span class="toc-section-number">4</span> Studying non-elephant animals</a></li>
</ul>
</div>

<style type="text/css">
div#TOC li {
    list-style:none;
    background-image:none;
    background-repeat:none;
    background-position:0; 
}
</style>
<p>Most non-fiction books teach you <strong>what</strong> to think. They give you a new set of facts to trot out when someone brings up pop psychology at the pub or let you feel smug when you ‘explain’ why the Bank of England cut interest rates. Every now and then, however, you read a book that changes <strong>how</strong> you think, one that helps you see things beyond its few hundred pages slightly differently. That’s what James Gleick’s <em>Chaos</em> did for me. It’s fantastic, I wish I’d read it much, much sooner, and anyone even remotely interested in science should make it their next book.</p>
<p>Instead of butchering a full explanation of chaos, I thought I’d run through an example on my home turf. Chapter 3 discusses chaos in the context of population biology by, in large part, recounting a <a href="http://abel.harvard.edu/archive/118r_spring_05/docs/may.pdf">1976 paper</a> from Robert May. I heard a guest lecture from him once, describing how studying complex ecosystems had helped him advise on the re-design of the banking system. It all went a fair distance over my head at the time. But, I think a combination of recognising his name, familiarity with population biology, and the memory of faculty members’ deference for May, made the chapter stick in my mind. Stickiest of all was Gleick’s summary of May’s argument:</p>
<blockquote>
<p>The world would be a better place… if every young student were given a pocket calculator and encouraged to play with the logistic difference equation. That simple calculation… could counter the distorted sense of the world’s possibilities that comes from a standard scientific education.</p>
</blockquote>
<p>Well, R is just a fancy pocket calculator. So, we best start playing.</p>
<div id="the-logistic-map" class="section level1">
<h1><span class="header-section-number">1</span> The logistic map</h1>
<p>Biologists often explore how a group of individuals of a single species changes over time (a ‘population’s dynamics’). The simplest way to do this is to consider time as being discrete. This means thinking in terms of the changes from one chunk of time (day, week, season, year) to the next, rather than in continuous underlying time.</p>
<p>This simplification actually describes species with non-overlapping generations accurately. For example, EXAMPLE. In this case, ‘studying dynamics’ often means finding the mathemetical rules that tell us what we should expect the total number of individuals in the next generation, <span class="math inline">\(N_{t+1}\)</span>, to be given how many individuals there are in this generation, <span class="math inline">\(N_t\)</span>. This post does include some equations but just think of them all in this light, they’re just rules telling you how many EXAMPLE you’ll have next year if this year you’ve got X.</p>
<p>So, say we’re looking for an equation describing a population’s dynamics from one year to the next. The simplest option might be to say that next year’s population depends only on this year’s and nothing else. This would give us the following equation:</p>
<p><span class="math display">\[N_{t+1} = rN_t\]</span></p>
<p>which says that the number of individuals next year, <span class="math inline">\(N_{t+1}\)</span>, is just the number of individuals this year, <span class="math inline">\(N_t\)</span>, multiplied by some parameter that encapsulates the growth rate, <span class="math inline">\(r\)</span>. The growth rate <span class="math inline">\(r\)</span> could be influenced by the climate, the species life-history evolution, or anything else you can think of. Just for clarity, if you have 100 individuals this year and <span class="math inline">\(r=0.5\)</span>, then next year you’ll have 50.</p>
<p>Let’s explore three populations starting with 100 individuals which have different growth rates.</p>
<p><img src="/posts/chaos_logistic_map_files/figure-html/unnamed-chunk-2-1.png" width="776.64" style="display: block; margin: auto;" /></p>
<p>This illustrates a general pattern:</p>
<ul>
<li>When <span class="math inline">\(r &lt; 1\)</span>, population goes to extinction.</li>
<li>When <span class="math inline">\(r = 1\)</span>, population is constant over time.</li>
<li>When <span class="math inline">\(r &gt; 1\)</span>, population grows exponentially.</li>
</ul>
<p>A prediction of exponential growth is normally a good sign that your model is a little too unrealistic. If we want a little more realism, then we can add in what population biologists call ‘density dependence’ and what mathematicians call ‘non-linearity’. This gives us an equation of the form:</p>
<p><span class="math display">\[N_{t+1} = N_t(a - bN_{t})\]</span></p>
<p>In his paper May tells us that we can use a transformation to make the equation simpler to work with. He defines what I’ll call the <em>population proportion</em> in generation <span class="math inline">\(t\)</span> as</p>
<p><span class="math display">\[x_t = \frac{bN_t}{a}\]</span></p>
<p><span class="math inline">\(x_t\)</span> is the population in generation <span class="math inline">\(t\)</span> as a fraction of the maximum possible population. So, if <span class="math inline">\(x_t = 0.5\)</span>, then the current population is half as big as the biggest one the environment could support.</p>
<p>But where does this helpful substitution come from? (probs don’t include this)</p>
<p><span class="math display">\[\begin{aligned}
N_{t+1} &amp;= aN_t - bN_{t}^2 \\
\frac{\delta N_{t+1}}{\delta N_{t}} &amp;= a - 2bN_t \\
2bN_t &amp;= a \\
N_t &amp;= \frac{a}{2b} \\
\end{aligned}\]</span></p>
<p>We can re-write the substitution in terms of <span class="math inline">\(N\)</span>,</p>
<p><span class="math display">\[N_t = \frac{ax_t}{b}\]</span></p>
<p>and then substitute it into our equation:</p>
<p><span class="math display">\[\begin{aligned}
N_{t+1} &amp;= aN_t - bN_{t}^2 \\
\frac{ax_{t+1}}{b} &amp;= a\frac{ax_t}{b} - b(\frac{ax_t}{b})^2 \\
\frac{ax_{t+1}}{b} &amp;= \frac{a^2x_t}{b} - \frac{a^2x_t^2}{b} \\
ax_{t+1} &amp;= a^2x_t - a^2x_t^2 \\
x_{t+1} &amp;= ax_t - ax_t^2 \\
x_{t+1} &amp;= ax_t(1-x_t)
\end{aligned}\]</span></p>
<p>What we end up with is <strong>the logistic map</strong>: an equation for the population proportion in generation t+1 as a function of the population proportion in generation t.</p>
<p><img src="/posts/chaos_logistic_map_files/figure-html/unnamed-chunk-3-1.png" width="776.64" style="display: block; margin: auto;" /></p>
<p>Make clear the distinction between linear and non-linear dynamics. It’s not just about having a curved line, e.g. exponential growth is linear dynamics.</p>
<p>Play through the maths slowly.</p>
</div>
<div id="summarising-complexity" class="section level1">
<h1><span class="header-section-number">2</span> Summarising complexity</h1>
<p>Stable point simulation, a = 2</p>
<p><img src="/posts/chaos_logistic_map_files/figure-html/unnamed-chunk-5-1.png" width="776.64" style="display: block; margin: auto;" /></p>
<p>Stable cycle simulation, a = 3</p>
<p><img src="/posts/chaos_logistic_map_files/figure-html/unnamed-chunk-6-1.png" width="776.64" style="display: block; margin: auto;" /></p>
<p>Chaos simulation, a = 3.65</p>
<p><img src="/posts/chaos_logistic_map_files/figure-html/unnamed-chunk-7-1.png" width="776.64" style="display: block; margin: auto;" /></p>
<p>But, how can we summarise this behaviour in a single graph. Make bifurcation diagram from May’s paper.</p>
<p>Can you make bifurcation diagram interactive so the user can zoom in?</p>
</div>
<div id="building-non-linear-intuitions" class="section level1">
<h1><span class="header-section-number">3</span> Building non-linear intuitions</h1>
<p>Bifurcation diagram is not intuitive at first glance because it’s showing long run outcomes as a function of a tuning parameter rather than direct outcomes. Fortunately, there’s been more than 40 years’ worth of technological advancement since May’s paper. This means that even a no-name chump who’s not a Baron can build an interactive graph that helps make May’s point a little easier to grasp.</p>
<p>Walk through step by step what they can do with the graph.</p>
<p>Best way to build intuition is to do it yourself.</p>
<p>So, I made a shiny app that allows you to choose the starting x point for the population.</p>
<p>Make a stripped back version of the real ap just for the blog.</p>
<p>Better to have the text be in the blog itself.</p>
<p>To understand its properties better we’ll compare 3 different simulated populations.</p>
<iframe width="900" height="700" scrolling="no" frameborder="no" align="left" src="https://mitchelfruin.shinyapps.io/log_map_lite/">
</iframe>
<p>Use the interactive graph that appears to build intuitions about non-linearity.</p>
<ul>
<li>Click the play button to see how the simulations of your 3 populations change as the value of a changes.</li>
<li>Shift the slider manually to see how all the populations transition from steady state equilibria, to periodic cycles, to chaos.</li>
<li>Hover over the lines to see what value a particular population has in a given generation for that value of <span class="math inline">\(a\)</span>.</li>
<li>Pick starting values close to one another and see how for some values of a the populations end up looking very different.</li>
</ul>
<p>Then click play and watch as we move through different values of the tuning parameter, <span class="math inline">\(a\)</span>. Regardless of which starting value(s) you choose, you’ll see stability at first with the population converging on a single equilibrium value, then there’ll be a transition to 2-period cycling with the population switching between two values, next 4-period cycles, 8-period cycles, and so on, and eventually chaos.</p>
<p>Question: Why do mirrors around 0.5 behave the same?</p>
</div>
<div id="studying-non-elephant-animals" class="section level1">
<h1><span class="header-section-number">4</span> Studying non-elephant animals</h1>
<p>In the conclusion of his paper, May argues that non-linearity should be taught, and taught early. As he saw it, learning to extend linear mathemetics with Fourier transforms, orthogonal functions, and regression techniques, misleads scientists about the world they’re trying to understand. “The mathmetical intuition so developed ill equips the student to confront the bizarre behaviour exhibited by the simplest discrete nonlinear systems.”, he wrote. “Yet such nonlinear systems are surely the rule, not the exception, outside the physical sciences.”</p>
<p>The crucial notion that nonlinear systems are the norm rather than the exception is summed up in my favourite quote from <em>Chaos</em> which comes from the mathematician Stanislaw Ulam. He quipped that “to call the study of chaos ‘nonlinear science’ was like calling zoology ‘the study of nonelephant animals’”. That is, it’s defining an entire subject in contrast to a niche class.</p>
<p>The fact that vast swathes of science emphasise linearity has important implications. Something about people thinking in immediate causes from misunderstanding economics book. Poor at incorporating feedback loops or interative thinking. May’s final sentence from over 40 years ago still rings true:</p>
<blockquote>
<p>“Not only in research, but also in the everday world of politics and economics, we would all be better off if more people realized that simple nonlinear systems do not necessarily possess simple dynamical properties.”</p>
</blockquote>
<p>Most things, especially the important things, are greater than the sum of their parts, and the hierarchical reductionism of much of science isn’t going to help us understand them even close to well enough.</p>
</div>

      </div>

      <footer>
        


        
        
      </footer>
    </article>

    
  </section>

      </div>

      <footer class="footer">
  <section class="container">
    
      <p>A man must have (a) code.</p>
    
     © 2020
    
       · 
      Powered by <a href="https://gohugo.io/">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/">Coder</a>.
    
    
       · 
      [<a href="https://github.com/luizdepra/hugo-coder/tree/"></a>]
    
  </section>
</footer>

<script src="//yihui.name/js/math-code.js"></script>
<script async
src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/r.min.js"></script>

<script>
hljs.configure({languages: []});
hljs.initHighlightingOnLoad();
</script>

    </main>

    

  </body>

</html>
