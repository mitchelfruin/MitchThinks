---
title: "Probability in the real world*"
date: "2019-08-15"
output:
  blogdown::html_page:
    toc: true
    toc_depth: 1
    number_sections: true
---


<div id="TOC">
<ul>
<li><a href="#probability-101"><span class="toc-section-number">1</span> Probability 101</a></li>
<li><a href="#legal-problems"><span class="toc-section-number">2</span> Legal problems</a></li>
<li><a href="#health-problems"><span class="toc-section-number">3</span> Health problems</a></li>
<li><a href="#research-problems"><span class="toc-section-number">4</span> Research problems</a></li>
<li><a href="#statistical-cognition"><span class="toc-section-number">5</span> Statistical cognition</a></li>
</ul>
</div>

<div id="probability-101" class="section level1">
<h1><span class="header-section-number">1</span> Probability 101</h1>
<div id="probability-vs.statistics" class="section level2">
<h2><span class="header-section-number">1.1</span> Probability vs. Statistics</h2>
<p>Probability: Use known state of the world to predict the data we should observe.</p>
<ul>
<li>I have a fair coin (known state of the world) and can expect 50 heads and 50 tails, on average, from 100 flips (predicted data).</li>
</ul>
<p>Statistics: Use data we have observed to infer the most likely state of the world.</p>
<ul>
<li>I flipped a coin 100 times and got 52 heads and 48 tails (observed data), I’m pretty sure that I have a fair coin (inferred state of the world).</li>
</ul>
</div>
<div id="types-of-probability" class="section level2">
<h2><span class="header-section-number">1.2</span> Types of probability</h2>
<p>Classic, based on symmetry.</p>
<p>Frequentist, based on experience.</p>
<p>Subjective, based on best guess.</p>
</div>
<div id="types-of-events" class="section level2">
<h2><span class="header-section-number">1.3</span> Types of events</h2>
<p><strong>Independent probabilities.</strong> Should multiply.</p>
<p><strong>Conditional probabilities.</strong> Should use Bayes law. Visualise Bayesian updating with a contingency table/ infographic.</p>
</div>
<div id="puzzles" class="section level2">
<h2><span class="header-section-number">1.4</span> Puzzles</h2>
<p>Sometimes probability is unintuitive. Birthday puzzle.</p>
</div>
</div>
<div id="legal-problems" class="section level1">
<h1><span class="header-section-number">2</span> Legal problems</h1>
<div id="ignoring-dependence" class="section level2">
<h2><span class="header-section-number">2.1</span> Ignoring dependence</h2>
<p>Sally Clark had two children dies from SIDS. Dr. Meadow, pediatrician, said there’s 1 in 8543 chance of having a child die from SIDS giving a 1 in 73mil chance of having two children die from it. Potential genetic, environmental dependence ignored and she was sentenced for 3 years.</p>
</div>
<div id="the-prosecutors-fallacy" class="section level2">
<h2><span class="header-section-number">2.2</span> The prosecutor’s fallacy</h2>
<p><strong>Prosecutor’s fallacy:</strong> False belief that conditional probabilities are invertible.</p>
<p><span class="math display">\[Pr(A|B) \neq Pr(B|A)\]</span></p>
<p>Forensics may compute that probability of blood at scene matching the defendent’s by chance is 1%. That doesn’t mean there’s a 1% chance the defendent is innocent. We have been told the probability of a match given innocence, we want the probability of innocence given a match, but they don’t equate:</p>
<p><span class="math display">\[Pr(\text{match}|\text{innocent}) \neq Pr(\text{innocent}|\text{match})\]</span></p>
</div>
</div>
<div id="health-problems" class="section level1">
<h1><span class="header-section-number">3</span> Health problems</h1>
<div id="base-rate-neglect" class="section level2">
<h2><span class="header-section-number">3.1</span> Base rate neglect</h2>
<p>Disease with 5% prevalence. Test is 95% accurate.</p>
<p>Let’s unpack the two parts of the scenario using an example population of 400 people.</p>
<p>Part 1: “The disease has a prevalence of 5%”:</p>
<ul>
<li>5% of the 400 people have the disease <span class="math inline">\(\rightarrow\)</span> 20 people</li>
<li>95% of the 400 people don’t <span class="math inline">\(\rightarrow\)</span> 380 people</li>
</ul>
<p>Part 2: “The test is 95% accurate”:</p>
<ul>
<li>For the 20 people with the disease
<ul>
<li>95% of them will be correctly identified as positive <span class="math inline">\(\rightarrow\)</span> 19 people
<ul>
<li>True positives</li>
</ul></li>
<li>5% of them will be incorrectly identified as negative <span class="math inline">\(\rightarrow\)</span> 1 person
<ul>
<li>False negatives</li>
</ul></li>
</ul></li>
<li>For the 380 people without the disease
<ul>
<li>95% of them will be correctly identified as negative <span class="math inline">\(\rightarrow\)</span> 361 people
<ul>
<li>True negatives</li>
</ul></li>
<li>5% of them will be incorrectly identified as positive <span class="math inline">\(\rightarrow\)</span> 19 people
<ul>
<li>False positives</li>
</ul></li>
</ul></li>
</ul>
<p>So, given you receive a positive result the probability you actually have the disease is:</p>
<p><span class="math display">\[\begin{aligned}
\text{Pr}(D|+) &amp;= \frac{\text{True pos.}}{\text{Total pos.}} \\
&amp;= \frac{19}{19 + 19} \\
&amp;= 0.5
\end{aligned}\]</span></p>
<pre class="r"><code># Waffle chart 400 people
example &lt;- c(&quot;True pos&quot; = 19, &quot;False pos&quot; = 19, &quot;True neg&quot; = 361, &quot;False neg&quot; = 1)

waffle(example,
       rows = 20)</code></pre>
<p><img src="/interests/probability_real_world_files/figure-html/base%20rate%20neglect-1.png" width="672" /></p>
<pre class="r"><code># Bar chart 1000 people
tibble(disease = c(&quot;Positive&quot;, &quot;Negative&quot;),
       test_pos = c(47.5, 47.5),
       test_neg = c(2.5, 902.5)) %&gt;%
  melt(id.vars = &quot;disease&quot;) %&gt;%
  ggplot(aes(x = disease, y = value, fill = variable)) +
  geom_col() +
  scale_x_discrete(&quot;Disease\nStatus&quot;) +
  scale_y_continuous(&quot;No. of People&quot;, limits = c(0, 1000)) +
  coord_flip() +
  theme_classic() +
  theme(axis.title.y = element_text(angle = 0, vjust = 0.5),
        panel.grid.major = element_line())</code></pre>
<p><img src="/interests/probability_real_world_files/figure-html/base%20rate%20neglect-2.png" width="672" /></p>
</div>
</div>
<div id="research-problems" class="section level1">
<h1><span class="header-section-number">4</span> Research problems</h1>
</div>
<div id="statistical-cognition" class="section level1">
<h1><span class="header-section-number">5</span> Statistical cognition</h1>
<div id="the-linda-problem" class="section level2">
<h2><span class="header-section-number">5.1</span> The linda problem</h2>
<p>Extra example of how we aren’t intuitive statisticians.</p>
</div>
<div id="all-averages-arent-made-equal" class="section level2">
<h2><span class="header-section-number">5.2</span> All averages aren’t made equal</h2>
<p>Relative percentage change vs. absolute percentage change (i.e. percentage points) vs. natural frequencies.</p>
</div>
</div>
